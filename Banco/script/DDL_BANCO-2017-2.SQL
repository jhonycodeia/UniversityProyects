/*
Created: 24/07/2017
Modified: 24/07/2017
Model: PostgreSQL 9.4
Database: PostgreSQL 9.4
*/


-- Create tables section -------------------------------------------------

-- Table CLIENTE

CREATE TABLE CLIENTE(
 CLIE_ID Numeric(30,0) NOT NULL,
 NOMBRE Varchar NOT NULL,
 DIRECCION Varchar NOT NULL,
 TELEFONO Varchar NOT NULL,
 EMAIL Varchar,
 ACTIVO Character(1) NOT NULL,
 TDOC_ID Bigint
)
;

-- Create indexes for table CLIENTE

CREATE INDEX IX_Relationship1 ON CLIENTE (TDOC_ID)
;

-- Add keys for table CLIENTE

ALTER TABLE CLIENTE ADD CONSTRAINT Key1 PRIMARY KEY (CLIE_ID)
;

-- Table TIPO_DOCUMENTO

CREATE TABLE TIPO_DOCUMENTO(
 TDOC_ID BigSerial NOT NULL,
 NOMBRE Varchar NOT NULL,
 ACTIVO Character(1) NOT NULL
)
;

-- Add keys for table TIPO_DOCUMENTO

ALTER TABLE TIPO_DOCUMENTO ADD CONSTRAINT Key2 PRIMARY KEY (TDOC_ID)
;

-- Table CUENTA

CREATE TABLE CUENTA(
 CUEN_ID Varchar NOT NULL,
 SALDO Numeric(30,6) NOT NULL,
 CLAVE Varchar NOT NULL,
 ACTIVA Character(1) NOT NULL,
 CLIE_ID Numeric(30,0)
)
;

-- Create indexes for table CUENTA

CREATE INDEX IX_Relationship2 ON CUENTA (CLIE_ID)
;

-- Add keys for table CUENTA

ALTER TABLE CUENTA ADD CONSTRAINT Key3 PRIMARY KEY (CUEN_ID)
;

-- Table CUENTA_REGISTRADA

CREATE TABLE CUENTA_REGISTRADA(
 CURE_ID BigSerial NOT NULL,
 CLIE_ID Numeric(30,0),
 CUEN_ID Varchar
)
;

-- Create indexes for table CUENTA_REGISTRADA

CREATE INDEX IX_Relationship3 ON CUENTA_REGISTRADA (CLIE_ID)
;

CREATE INDEX IX_Relationship4 ON CUENTA_REGISTRADA (CUEN_ID)
;

-- Add keys for table CUENTA_REGISTRADA

ALTER TABLE CUENTA_REGISTRADA ADD CONSTRAINT Key4 PRIMARY KEY (CURE_ID)
;

-- Table TRANSACCION

CREATE TABLE TRANSACCION(
 TRAN_ID BigSerial NOT NULL,
 CUEN_ID Varchar,
 VALOR Numeric(30,6) NOT NULL,
 FECHA Timestamp NOT NULL,
 USU_USUARIO Varchar,
 TITR_ID Bigint
)
;

-- Create indexes for table TRANSACCION

CREATE INDEX IX_Relationship5 ON TRANSACCION (CUEN_ID)
;

CREATE INDEX IX_Relationship7 ON TRANSACCION (USU_USUARIO)
;

CREATE INDEX IX_Relationship8 ON TRANSACCION (TITR_ID)
;

-- Add keys for table TRANSACCION

ALTER TABLE TRANSACCION ADD CONSTRAINT Key5 PRIMARY KEY (TRAN_ID)
;

-- Table USUARIO

CREATE TABLE USUARIO(
 USU_USUARIO Varchar NOT NULL,
 CLAVE Varchar NOT NULL,
 IDENTIFICACION Numeric(30,0) NOT NULL,
 NOMBRE Varchar NOT NULL,
 ACTIVO Character(1) NOT NULL,
 TIUS_ID Bigint
)
;

-- Create indexes for table USUARIO

CREATE INDEX IX_Relationship6 ON USUARIO (TIUS_ID)
;

-- Add keys for table USUARIO

ALTER TABLE USUARIO ADD CONSTRAINT Key6 PRIMARY KEY (USU_USUARIO)
;

-- Table TIPO_USUARIO

CREATE TABLE TIPO_USUARIO(
 TIUS_ID BigSerial NOT NULL,
 NOMBRE Varchar NOT NULL,
 ACTIVO Character(1) NOT NULL
)
;

-- Add keys for table TIPO_USUARIO

ALTER TABLE TIPO_USUARIO ADD CONSTRAINT Key7 PRIMARY KEY (TIUS_ID)
;

-- Table TIPO_TRANSACCION

CREATE TABLE TIPO_TRANSACCION(
 TITR_ID BigSerial NOT NULL,
 NOMBRE Varchar NOT NULL,
 ACTIVO Character(1) NOT NULL
)
;

-- Add keys for table TIPO_TRANSACCION

ALTER TABLE TIPO_TRANSACCION ADD CONSTRAINT Key8 PRIMARY KEY (TITR_ID)
;

-- Create relationships section ------------------------------------------------- 

ALTER TABLE CLIENTE ADD CONSTRAINT FK_TIPODOCUMENTO_CLIENTE FOREIGN KEY (TDOC_ID) REFERENCES TIPO_DOCUMENTO (TDOC_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE CUENTA ADD CONSTRAINT FK_CLIENTE_CUENTA FOREIGN KEY (CLIE_ID) REFERENCES CLIENTE (CLIE_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE CUENTA_REGISTRADA ADD CONSTRAINT FK_CLIENTE_CUENTA_REGISTRADA FOREIGN KEY (CLIE_ID) REFERENCES CLIENTE (CLIE_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE CUENTA_REGISTRADA ADD CONSTRAINT FK_CUENTA_CUENTA_REGISTRADA FOREIGN KEY (CUEN_ID) REFERENCES CUENTA (CUEN_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE TRANSACCION ADD CONSTRAINT FK_CUENTA_TRANSACCION FOREIGN KEY (CUEN_ID) REFERENCES CUENTA (CUEN_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE USUARIO ADD CONSTRAINT FK_TIPO_USUARIO_USUARIO FOREIGN KEY (TIUS_ID) REFERENCES TIPO_USUARIO (TIUS_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE TRANSACCION ADD CONSTRAINT FK_USUARIO_TRANSACCION FOREIGN KEY (USU_USUARIO) REFERENCES USUARIO (USU_USUARIO) ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE TRANSACCION ADD CONSTRAINT FK_TIPO_TRANSACCION_TRANSACCION FOREIGN KEY (TITR_ID) REFERENCES TIPO_TRANSACCION (TITR_ID) ON DELETE NO ACTION ON UPDATE NO ACTION
;





